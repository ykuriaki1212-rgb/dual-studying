# スタディダッシュボード Googleスプレッドシート連携 セットアップガイド

## 📋 概要

このダッシュボードは、社会保険労務士試験と行政書士試験のダブル受験をサポートするツールです。
Googleスプレッドシートと連携することで、PC・スマホ・タブレットで同じデータを共有できます。

## 🎯 主な機能

- ✅ 試験日までのカウントダウン表示
- ✅ 20科目の周回数管理（社労士10科目 + 行政書士10科目）
- ✅ 行政書士の月次レビュートラッカー
- ✅ 12ヶ月学習ロードマップ
- ✅ 現在フェーズの自動表示
- ✅ デバイス間でのデータ同期
- ✅ オフライン時はLocalStorageで動作
- ✅ YouTubeおすすめチャンネルリンク集

## 🚀 セットアップ手順

### Step 1: スプレッドシートの作成

1. **Google Driveにアクセス**
   - https://drive.google.com にアクセス

2. **新規スプレッドシートを作成**
   - 「新規」→「Googleスプレッドシート」→「空白のスプレッドシート」

3. **スプレッドシート名を変更**
   - 左上のタイトルを「**ダブル受験進捗記録簿**」に変更

4. **スプレッドシートIDをコピー**
   - URLから以下の部分をコピー
   - `https://docs.google.com/spreadsheets/d/【この部分がID】/edit`
   - 例: `1ABcD2EfGhI3JkLmN4oPqR5sTuVwX6yZ`

### Step 2: Google Apps Scriptの設定

1. **Apps Scriptエディタを開く**
   - スプレッドシートで「拡張機能」→「Apps Script」

2. **コードを貼り付け**
   - `google_apps_script.gs` の内容を全てコピー
   - Apps Scriptエディタに貼り付け（既存のコードは削除）

3. **スプレッドシートIDを設定**
   - 3行目の `YOUR_SPREADSHEET_ID` を、Step 1でコピーしたIDに置き換え
   ```javascript
   const SPREADSHEET_ID = '1ABcD2EfGhI3JkLmN4oPqR5sTuVwX6yZ'; // ← 自分のIDに置き換え
   ```

4. **保存**
   - ディスクアイコン（💾）をクリックして保存
   - プロジェクト名を「ダブル受験ダッシュボードAPI」などに変更（任意）

### Step 3: スプレッドシートの初期化

1. **関数を選択**
   - 関数セレクタで「**testInit**」を選択
   ![関数セレクタ](https://i.imgur.com/example1.png)

2. **実行**
   - 「実行」ボタン（▶）をクリック

3. **初回認証**
   - 「承認が必要です」と表示される → 「権限を確認」
   - アカウントを選択
   - 「詳細」→「（プロジェクト名）に移動」
   - 「許可」をクリック

4. **実行ログを確認**
   - 「実行ログ」タブを開く
   - 以下のメッセージが表示されればOK
   ```
   === ✅ 初期化が完了しました ===
   ```

5. **スプレッドシートを確認**
   - 元のスプレッドシートに戻る
   - 「進捗データ」と「更新ログ」の2つのシートが作成されていることを確認

6. **書式設定（オプション）**
   - 見た目を整えたい場合は、関数セレクタで「**formatSheets**」を選択して実行

### Step 4: Webアプリとしてデプロイ

1. **デプロイを開始**
   - Apps Scriptエディタ右上の「デプロイ」→「新しいデプロイ」

2. **デプロイの設定**
   - 「種類の選択」→「ウェブアプリ」を選択
   - 設定内容:
     - 説明: 「初回デプロイ」など（任意）
     - 次のユーザーとして実行: **自分**
     - アクセスできるユーザー: **全員** ← 重要！

3. **デプロイ実行**
   - 「デプロイ」ボタンをクリック
   - 再度認証を求められた場合は承認

4. **URLをコピー**
   - 「ウェブアプリのURL」が表示される
   - URLを全てコピー
   - 例: `https://script.google.com/macros/s/AKfycbz.../exec`

### Step 5: HTMLファイルの設定

1. **dashboard.htmlを開く**
   - テキストエディタで `dashboard.html` を開く

2. **API URLを設定**
   - 56行目付近の以下の部分を探す
   ```javascript
   const API_URL = 'https://script.google.com/macros/s/XXXXX/exec';
   ```
   - `XXXXX` の部分をStep 4でコピーしたURLに置き換え
   ```javascript
   const API_URL = 'https://script.google.com/macros/s/AKfycbz.../exec';
   ```

3. **保存**
   - ファイルを保存

### Step 6: 動作確認

1. **HTMLファイルをブラウザで開く**
   - `dashboard.html` をダブルクリック、またはブラウザにドラッグ&ドロップ

2. **同期ステータスを確認**
   - ページ右上に「🟢 同期済み」と表示されればOK
   - 「🔴 オフライン」と表示される場合:
     - ブラウザのコンソール（F12）でエラーを確認
     - API URLが正しいか再確認
     - Apps Scriptのデプロイ設定で「アクセスできるユーザー: 全員」になっているか確認

3. **データ保存テスト**
   - いずれかの科目の「+」ボタンをクリック
   - 数秒後に「🟢 同期済み」になることを確認
   - スプレッドシートを開いて、「進捗データ」シートにデータが保存されているか確認

4. **マルチデバイステスト**
   - スマホやタブレットで同じHTMLファイルを開く
   - 同じデータが表示されることを確認
   - どちらかのデバイスでデータを変更し、もう一方でリロードして同期を確認

## 📊 データ構造

### 進捗データシート

| カラム | 内容 |
|--------|------|
| ID | 固定値 "main" |
| 最終更新日時 | ISO 8601形式のタイムスタンプ |
| sr1〜sr10 | 社労士科目の周回数（0以上の整数） |
| gs1〜gs10 | 行政書士科目の周回数（0以上の整数） |
| 2025-12-L1, L2 | 12月のレビュー状態（true/false） |
| 2026-01-L1, L2 | 1月のレビュー状態 |
| 2026-02-L1, L2 | 2月のレビュー状態 |
| 2026-03-L1, L2, L3 | 3月のレビュー状態（L3あり） |
| 2026-04-L1, L2 | 4月のレビュー状態 |
| 2026-05-L1, L2 | 5月のレビュー状態 |
| 2026-06-L1, L2, L3 | 6月のレビュー状態（L3あり） |

### 科目コード対応表

**社労士（sr1〜sr10）:**
- sr1: 労働基準法（目標10回）
- sr2: 労働安全衛生法（目標8回）
- sr3: 労働者災害補償保険法（目標8回）
- sr4: 雇用保険法（目標8回）
- sr5: 労働保険徴収法（目標6回）
- sr6: 健康保険法（目標10回）
- sr7: 国民年金法（目標10回）
- sr8: 厚生年金保険法（目標10回）
- sr9: 労務管理・一般常識（目標6回）
- sr10: 社会保険・一般常識（目標6回）

**行政書士（gs1〜gs10）:**
- gs1: 憲法（目標5回）
- gs2: 行政法総論（目標5回）
- gs3: 行政手続法（目標5回）
- gs4: 行政不服審査法（目標5回）
- gs5: 行政事件訴訟法（目標5回）
- gs6: 国家賠償法・地方自治法（目標5回）
- gs7: 民法（目標5回）
- gs8: 商法・会社法（目標3回）
- gs9: 基礎法学（目標2回）
- gs10: 一般知識（目標3回）

## 🔧 トラブルシューティング

### 「オフライン」と表示される

**原因1: API URLが未設定**
- `dashboard.html` の `API_URL` に正しいURLが設定されているか確認

**原因2: デプロイ設定が間違っている**
- Apps Scriptで「デプロイ」→「デプロイを管理」
- 「アクセスできるユーザー」が「全員」になっているか確認
- 「自分」になっている場合は、歯車アイコンから編集して「全員」に変更

**原因3: CORS エラー**
- ブラウザのコンソール（F12）を開いてエラーを確認
- `redirect: 'follow'` がfetchに設定されているか確認

### データが保存されない

**確認1: スプレッドシートの権限**
- スプレッドシートが自分のアカウントで作成されているか確認

**確認2: Apps Scriptの実行権限**
- testInit関数を実行した際に認証を許可したか確認

**確認3: 更新ログを確認**
- スプレッドシートの「更新ログ」シートを開く
- 保存操作が記録されているか確認

### デバイス間で同期されない

**解決策:**
- 片方のデバイスでページをリロード（F5）
- 保存後、1〜2秒待ってから他のデバイスでリロード
- ネットワーク接続を確認

## ⚡ 高度な使い方

### データのバックアップ

スプレッドシートのデータは定期的にバックアップすることをおすすめします。

1. スプレッドシートを開く
2. 「ファイル」→「コピーを作成」
3. 名前を「ダブル受験進捗記録簿_バックアップ_YYYYMMDD」などに設定

### データのエクスポート

CSV形式でエクスポートして、Excelなどで分析できます。

1. 「進捗データ」シートを開く
2. 「ファイル」→「ダウンロード」→「カンマ区切り形式（.csv）」

### Apps Scriptのログ確認

エラーが発生した場合の詳細確認:

1. Apps Scriptエディタを開く
2. 左メニューの「実行数」をクリック
3. 最近の実行履歴とエラーログを確認

## 📱 スマホでの使用

### iOSの場合

1. Safariで `dashboard.html` を開く
2. 画面下部の共有ボタン → 「ホーム画面に追加」
3. アプリのようにホーム画面から起動可能

### Androidの場合

1. Chromeで `dashboard.html` を開く
2. 右上のメニュー → 「ホーム画面に追加」
3. アプリのようにホーム画面から起動可能

## ✅ 完成確認チェックリスト

- [ ] スプレッドシートが「ダブル受験進捗記録簿」という名前で作成されている
- [ ] 「進捗データ」と「更新ログ」の2つのシートが存在する
- [ ] Apps Scriptの `SPREADSHEET_ID` が正しく設定されている
- [ ] testInit関数を実行して「✅ 初期化が完了しました」が表示された
- [ ] Webアプリとしてデプロイされている（アクセス権限: 全員）
- [ ] `dashboard.html` の `API_URL` にデプロイURLが設定されている
- [ ] HTMLを開いたときに「🟢 同期済み」と表示される
- [ ] 科目の +/− ボタンを押すと約1秒後に自動保存される
- [ ] スプレッドシートに保存されたデータが反映される
- [ ] PC・スマホで同じデータが表示される

## 📚 参考情報

### 試験日

- **社会保険労務士試験**: 2026年8月23日（日）
- **行政書士試験**: 2026年11月8日（日）

### 学習ペース目安

- 社労士: 2025年12月〜2026年8月（9ヶ月）
- 行政書士: 2025年12月〜2026年11月（12ヶ月）

### YouTubeチャンネル活用法

ダッシュボード下部にあるYouTubeチャンネルリンクを活用してください:

- **社労士系**: アガルート、フォーサイト、資格の大原など
- **行政書士系**: ゆーき大学、伊藤塾、資格スクエアなど
- **おすすめ**: 通勤時間は聞き流し、休日は1.5〜2倍速で視聴

## 🆘 サポート

問題が解決しない場合は、以下を確認してください:

1. ブラウザのコンソール（F12）でエラーメッセージを確認
2. Apps Scriptの実行ログを確認
3. スプレッドシートの権限設定を確認

---

**製作**: 2026年度ダブル受験サポートプロジェクト  
**更新日**: 2026年1月1日

頑張ってください！🎓
